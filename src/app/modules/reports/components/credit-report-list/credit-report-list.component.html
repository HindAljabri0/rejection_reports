<div class="block-header has-border">
    <p>Credit Reports</p>
</div>
<div class="block-filter-panel has-border">
    <div class="row small-gutter">
        <div class="col">
            <div class="form-group">
                <label class="control-label">Payer</label>
                <mat-form-field class="form-control custom-select-control">
                    <mat-select [(ngModel)]='creditReportSearchModel.payerId' (selectionChange)="checkFileUploadVisible()">
                        <!-- <mat-option value="">Select Payer</mat-option> -->
                        <mat-option [value]="102">Tawuniya</mat-option>
                        <mat-option [value]="319">Bupa</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>
        <div class="col">
            <div class="form-group">
                <label class="control-label">Received Date From</label>
                <div class="date-picker">
                    <input [matDatepicker]="fromDate" class="form-control" placeholder="Select from date" [(ngModel)]='creditReportSearchModel.receivedFromDate' />
                    <mat-datepicker-toggle [for]="fromDate"></mat-datepicker-toggle>
                    <mat-datepicker #fromDate></mat-datepicker>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="form-group">
                <label class="control-label">Received Date To</label>
                <div class="date-picker">
                    <input [matDatepicker]="toDate" class="form-control" placeholder="Select to date" [(ngModel)]='creditReportSearchModel.receivedToDate' />
                    <mat-datepicker-toggle [for]="toDate"></mat-datepicker-toggle>
                    <mat-datepicker #toDate></mat-datepicker>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="form-group">
                <label class="control-label">Batch ID</label>
                <input class="form-control" placeholder="Enter batch ID" [(ngModel)]='creditReportSearchModel.batchId' />
            </div>
        </div>
        <div class="col-auto align-self-end">
            <div class="form-group">
                <button type="button" (click)="searchCreditReports()" mat-flat-button color="primary">Search</button>
            </div>
        </div>
    </div>
</div>
<ul class="nav nav-tabs" *ngIf="creditReportSearchModel.payerId == 102">
    <li class="nav-item">
        <a class="nav-link" href="#" [class.active]="currentStatus=='All'" (click)="changeTab($event,'All')" title="All">All</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" [class.active]="currentStatus=='NEW'" (click)="changeTab($event,'NEW')" title="New">New</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" [class.active]="currentStatus=='UNDERREVIEW'" (click)="changeTab($event,'UNDERREVIEW')" title="Under Review">Under Review</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" [class.active]="currentStatus=='UNDERSUBMISSION'" (click)="changeTab($event,'UNDERSUBMISSION')" title="Under Submission">Under Submission</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" [class.active]="currentStatus=='SUBMITTED'" (click)="changeTab($event,'SUBMITTED')" title="Submitted">Submitted</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" [class.active]="currentStatus=='INVALID'" (click)="changeTab($event,'INVALID')" title="Invalid">Invalid</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" [class.active]="currentStatus=='FAILED'" (click)="changeTab($event,'FAILED')" title="Failed">Failed</a>
    </li>
</ul>
<div class="bg-white table-responsive">
    <table class="primary-grid" cellpadding="0" cellspacing="0" border="0">
        <thead>
            <tr>
                <!-- <th>Payer Name</th> -->
                <th>Received Date</th>
                <th>Batch Id</th>
                <th>Total Rejections Amount</th>
                <th>Medical Rejection ratio</th>
                <th>Technical Rejection ratio</th>
                <th>Remaining Days</th>
                <th>Progress Status</th>
                <!-- <th>Team Members</th> -->
                <th width="10" *ngIf="!isBupaRecord"></th>
            </tr>
        </thead>
        <tbody>
            <!-- routerLink="/reports/creditReports/tawuniya/batch//{{item.batchId}}" -->
            <tr *ngFor="let item of creditReportData; let i=index" (click)="goToSummaryPage(item)">
                <!-- <td class="semibold text-primary row-click">{{item.payerName}}</td> -->
                <td class="row-click">{{item.receivedDate | date : 'dd/MM/yyyy'}}</td>
                <td class="row-click">{{item.batchId}}</td>
                <td class="row-click">{{item.totalRejectionsAmount}}</td>
                <td class="row-click">{{item.medicalRejectionRatio}}</td>
                <td class="row-click">{{item.technicalRejectionRatio}}</td>

                <!-- Tawuniya -->
                <td class="row-click" *ngIf="creditReportSearchModel.payerId != 319">{{item.remainingDays}} Days
                    Remaining</td>

                <!-- Bupa -->
                <td class="row-click" *ngIf="isBupaRecord">NA</td>

                <!-- Tawuniya -->
                <td class="row-click" *ngIf="creditReportSearchModel.payerId != 319">
                    <div class="status-text ball-red" *ngIf="item.status=='NEW'">New</div>
                    <div class="status-text ball-blue" *ngIf="item.status=='UNDERREVIEW'">Under Review</div>
                    <div class="status-text ball-brown" *ngIf="item.status=='UNDERSUBMISSION'">Under Submission</div>
                    <div class="status-text ball-green" *ngIf="item.status=='SUBMITTED'">Submitted</div>
                    <div class="status-text ball-red" *ngIf="item.status=='INVALID'">Invalid</div>
                    <div class="status-text ball-red" *ngIf="item.status=='FAILED'">Failed</div>
                </td>

                <!-- Bupa -->
                <td class="row-click" *ngIf="isBupaRecord">
                    <div class="status-text ball-red">New</div>
                </td>

                <!-- Tawuniya -->
                <!-- <td (click)="$event.stopPropagation()" *ngIf="!isBupaRecord">
                    <a href="#" (click)="$event.preventDefault()" class="primary-link" *ngIf="i==0"
                        title="@Ahmed Al yosif">@Ahmed Al yosif</a>
                    <a href="#" (click)="$event.preventDefault()" class="primary-link" *ngIf="i==1"
                        title="Assign To">Assign To</a>
                </td> -->

                <!-- Bupa -->
                <!-- <td (click)="$event.stopPropagation()" *ngIf="isBupaRecord">
                    NA</td> -->

                <td width="10" class="actions" *ngIf="!isBupaRecord">
                    <button type="button" mat-icon-button class="text-danger" *ngIf="item.status=='INVALID'||item.status=='FAILED'" (click)="openErrorsDialog($event,item)">
                        <mat-icon>error</mat-icon>
                    </button>
                </td>
            </tr>
            <tr>
                <td colspan="9" class="p-0">
                    <app-empty-state *ngIf="creditReportData == null || creditReportData.length == 0" class="claim-list-empty-state" message='No reports found!'>
                    </app-empty-state>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<div class="block-footer sticky-bottom" *ngIf="!isLoading">
    <div class="left-block custom-paginator" *ngIf="creditReportSearchModel.totalPages > 0">
        <button matRipple (click)="goToFirstPage()" type="button" title="First Page" [disabled]="creditReportSearchModel.pageNo==0">
            <img src="./assets/ic-page-first.svg" alt="First" />
        </button>
        <button matRipple (click)="goToPrePage()" type="button" title="Previous Page" [disabled]="creditReportSearchModel.pageNo==0">
            <img src="./assets/ic-page-prev.svg" alt="Previous" />
        </button>
        <p class="page-info">
            {{(creditReportSearchModel.pageNo+1)}}<small>/{{creditReportSearchModel.totalPages }}</small>
        </p>
        <button matRipple (click)="goToNextPage()" type="button" title="Next Page" [disabled]="(creditReportSearchModel.pageNo+1)==creditReportSearchModel.totalPages ">
            <img src="./assets/ic-page-next.svg" alt="Next" />
        </button>
        <button matRipple (click)="goToLastPage()" type="button" title="Last Page" [disabled]="(creditReportSearchModel.pageNo+1)==creditReportSearchModel.totalPages ">
            <img src="./assets/ic-page-last.svg" alt="Last" />
        </button>
    </div>
</div>

<div class="file-upload-wrapper page-fab" *ngIf="isFileUploadVisible">
    <div class="content">
        <button mat-fab color="primary" class="page-fab">
            <mat-icon>add</mat-icon>
        </button>
    </div>
    <input type="file" accept=".pdf" class="file-upload-control" (click)="clearFiles($event)" (change)="openPdf($event)" />

    <!-- <div class="custom-paginator ng-star-inserted">
        <div class="left-block">
            <div class="custom-paginator ng-star-inserted"  >
    <button class="mat-ripple" matripple="" title="First Page" type="button" disabled="">
        <img alt="First" src="./assets/ic-page-first.svg">
    </button>
    <button class="mat-ripple" matripple="" title="Previous Page" type="button" disabled="">
        <img alt="Previous" src="./assets/ic-page-prev.svg">
    </button>
    <p class="page-info"> 1<small>/1</small></p>
    <button class="mat-ripple" matripple="" title="Next Page" type="button" disabled="">
        <img alt="Next" src="./assets/ic-page-next.svg">
    </button>
    <button class="mat-ripple" matripple="" title="Last Page" type="button" disabled="">
        <img alt="Last" src="./assets/ic-page-last.svg">
    </button>
    </div>
        </div>
    </div> -->