<mat-progress-bar *ngIf="isLoading && pageMode != 'CREATE' && pageMode != 'CREATE_FROM_RETRIEVED'" mode="indeterminate" style="position: fixed;"></mat-progress-bar>
<div class="parent" [ngClass]="{'mainPage': pageMode == 'CREATE' || pageMode == 'CREATE_FROM_RETRIEVED'}">
    <div class="header" [ngStyle]="{'color': pageMode == 'CREATE' || pageMode == 'CREATE_FROM_RETRIEVED'? '#3060AA':getClaimStatusColor(claimProps?.statusCode),
        'background-color': pageMode == 'CREATE' || pageMode == 'CREATE_FROM_RETRIEVED'? 'white':getClaimStatusColor(claimProps?.statusCode)+'40'}">
        <ng-container *ngIf="pageMode == 'CREATE' || pageMode == 'CREATE_FROM_RETRIEVED'; else statusHeader">
            <p>Create Claim</p><span class="spacer"></span>
            <p *ngIf="claim != null && errors == null && claim.visitInformation != null" class="hiddenByDefault"
                [ngClass]="{'show':claim != null && errors == null}">
                {{(claim.visitInformation.departmentCode==dentalDepartmentCode)?'Dental':'Optical'}}</p>
        </ng-container>
        <ng-template #statusHeader>
            <ng-container *ngIf="claim != null && claimProps != null">
                <p style="margin-right: 50px;">View Claim</p>
                <p><strong>Provider Reference No.:</strong> {{claim.claimIdentities.providerClaimNumber}}</p>
                <p *ngIf="claim.claimIdentities.providerBatchID != null"><strong>Batch ID:</strong>
                    {{claim.claimIdentities.providerBatchID}}</p>
                <p><strong>Status:</strong> {{getClaimStatusLabel(claimProps.statusCode)}}</p>
                <p *ngIf="claimProps.statusDetail != null"><strong>Status Description:</strong>
                    {{claimProps.statusDetail}}</p>
            </ng-container>

        </ng-template>
    </div>
    <div class="body" [ngStyle]="{'height': claim == null? '40vw': 'unset'}">
        <div class="error" *ngIf="errors != null && !isLoading" style="grid-column: 1 / span 12;">
            {{getError()}}
        </div>
        <ng-container *ngIf="claim != null && errors == null">
            <claim-patient-info style="grid-column: 1 / span 8; margin: 5px;"></claim-patient-info>
            <claim-physician-header style="grid-column: 9 / span 4; margin: 5px;"></claim-physician-header>
            <claim-data style="grid-column: 1 / span 8; margin: 5px; height: 26vw;"
                [ngStyle]="{'height': pageMode != 'CREATE'  && pageMode != 'CREATE_FROM_RETRIEVED' ? '34vw': '26vw'}"></claim-data>
            <gdpn-calculation style="grid-column: 9 / span 4; margin: 5px;"></gdpn-calculation>
        </ng-container>
    </div>
    <div class="footer" *ngIf="pageMode == 'CREATE' || pageMode == 'CREATE_FROM_RETRIEVED'">
        <span class="spacer"></span>
        <button *ngIf="claim != null" mat-flat-button style="margin-right: 10px;" (click)="cancel()">Cancel</button>
        <button *ngIf="claim != null" mat-raised-button color="primary" style="margin-right: 10px;"
            (click)="save()">Save</button>
    </div>
    <div class="footer" *ngIf="pageMode == 'VIEW'">
        <span class="spacer"></span>
        <button *ngIf="claim != null" mat-flat-button style="margin-right: 10px;" (click)="close()">Close</button>
        <button *ngIf="claim != null && editable" mat-raised-button color="primary" style="margin-right: 10px;"
            (click)="edit()">Edit</button>
    </div>
    <div class="footer" *ngIf="pageMode == 'EDIT'">
        <span class="spacer"></span>
        <button *ngIf="claim != null && !isLoading" mat-flat-button style="margin-right: 10px;" (click)="cancel()">Cancel</button>
        <button *ngIf="claim != null && !isLoading" mat-raised-button color="primary" style="margin-right: 10px;"
            (click)="save()">Save</button>
    </div>
</div>

<button mat-fab color="primary" class="fabButton" [matMenuTriggerFor]="claimTypeMenu"
    *ngIf="pageMode == 'CREATE' && claim == null && errors == null && !isLoading">
    <mat-icon>add</mat-icon>
</button>

<mat-menu #claimTypeMenu yPosition="above" xPosition="before">
    <ng-template matMenuContent>
        <label>Claim Type</label>
        <button mat-menu-item (click)="startCreatingClaim(dentalDepartmentCode)">Dental</button>
        <button mat-menu-item (click)="startCreatingClaim(opticalDepartmentCode)">Optical</button>
    </ng-template>
</mat-menu>